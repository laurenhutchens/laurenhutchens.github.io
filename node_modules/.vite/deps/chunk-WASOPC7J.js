import {
  effect_tracking,
  get,
  increment,
  render_effect,
  source,
  tag,
  tick,
  untrack
} from "./chunk-3FTLRAP7.js";
import {
  true_default
} from "./chunk-YDZRRHXC.js";

// node_modules/svelte/src/reactivity/create-subscriber.js
function createSubscriber(start) {
  let subscribers = 0;
  let version = source(0);
  let stop;
  if (true_default) {
    tag(version, "createSubscriber version");
  }
  return () => {
    if (effect_tracking()) {
      get(version);
      render_effect(() => {
        if (subscribers === 0) {
          stop = untrack(() => start(() => increment(version)));
        }
        subscribers += 1;
        return () => {
          tick().then(() => {
            subscribers -= 1;
            if (subscribers === 0) {
              stop == null ? void 0 : stop();
              stop = void 0;
            }
          });
        };
      });
    }
  };
}

export {
  createSubscriber
};
//# sourceMappingURL=chunk-WASOPC7J.js.map
